(()=>{var e={};e.id=807,e.ids=[807],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4376:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(735),a=r(1232),i=r(2914),n=r.n(i),o=r(85),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["pos",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2211)),"C:\\Users\\tinkpad\\Desktop\\Mes Nouveaux Projets\\Sahel Ubuntu Pharm\\apps\\web\\app\\pos\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6397)),"C:\\Users\\tinkpad\\Desktop\\Mes Nouveaux Projets\\Sahel Ubuntu Pharm\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,8270,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,5335,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,4908,23)),"next/dist/client/components/unauthorized-error"]}],c=["C:\\Users\\tinkpad\\Desktop\\Mes Nouveaux Projets\\Sahel Ubuntu Pharm\\apps\\web\\app\\pos\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/pos/page",pathname:"/pos",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9012:(e,t,r)=>{Promise.resolve().then(r.bind(r,2211))},7572:(e,t,r)=>{Promise.resolve().then(r.bind(r,5601))},5601:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(2725),a=r(1616),i=r(1170),n=r(8630);let o=(0,n.A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),l=(0,n.A)("ScanBarcode",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]]),d=(0,n.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var c=r(2798),p=r(3846),u=r(9007),x=r(39),h=r(6033),m=r(4656),f=r(5102),v=r(5827);function y(){let[e,t]=(0,a.useState)(""),[r,n]=(0,a.useState)([]),[y,g]=(0,a.useState)([]),[b,j]=(0,a.useState)(!0),N=(0,a.useRef)(null);async function w(){try{let e=await fetch("/api/products");if(e.ok){let t=(await e.json()).map(e=>({id:e.id,name:e.name,price:e.sellingPrice,stock:e.stock}));g(t)}}catch(e){console.error("Erreur chargement produits",e)}finally{j(!1)}}let k=y.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),P=e=>{if(e.stock<=0){alert("Rupture de stock !");return}n(t=>{let r=t.find(t=>t.id===e.id);return r?r.quantity>=e.stock?(alert("Stock insuffisant pour ajouter plus !"),t):t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{...e,quantity:1}]})},S=(e,t)=>{n(r=>r.map(r=>{if(r.id===e){let e=r.quantity+t;return e<=0?null:{...r,quantity:e}}return r}).filter(Boolean))},q=r.reduce((e,t)=>e+t.price*t.quantity,0),C=async()=>{if(0!==r.length)try{let e={items:r.map(e=>({productId:e.id,quantity:e.quantity,sellingPrice:e.price})),paymentMethod:"CASH"},t=await fetch("/api/sales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(!t.ok)throw Error(s.error||"Erreur transaction");window.open(`/pos/print/${s.transactionId}`,"_blank"),n([]),w()}catch(e){alert("Erreur lors de la vente: "+e.message)}};return(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 h-[calc(100vh-100px)]",children:[(0,s.jsxs)("div",{className:"md:col-span-2 space-y-4 flex flex-col h-full",children:[(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(i.A,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),(0,s.jsx)(u.p,{ref:N,placeholder:"Scanner ou chercher (DCI, Nom)...",className:"pl-10 text-lg py-6",autoFocus:!0,value:e,onChange:e=>t(e.target.value)})]})}),(0,s.jsx)(m.F,{className:"flex-1 border rounded-md p-4 bg-white/50",children:b?(0,s.jsx)("div",{className:"p-10 text-center",children:"Chargement..."}):(0,s.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:k.map(e=>(0,s.jsx)(h.Zp,{className:`cursor-pointer hover:border-primary transition-colors ${0===e.stock?"opacity-50 grayscale":""}`,onClick:()=>P(e),children:(0,s.jsxs)(h.Wu,{className:"p-4 text-center space-y-2",children:[(0,s.jsx)("div",{className:"font-bold truncate",title:e.name,children:e.name}),(0,s.jsxs)("div",{className:"text-primary font-mono font-bold text-lg",children:[e.price.toLocaleString()," F"]}),(0,s.jsxs)(f.E,{variant:e.stock>10?"secondary":"destructive",children:["Stock: ",e.stock]})]})},e.id))})})]}),(0,s.jsxs)(h.Zp,{className:"flex flex-col h-full border-l-4 border-l-primary shadow-xl",children:[(0,s.jsx)(h.aR,{className:"border-b bg-muted/20",children:(0,s.jsxs)(h.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(o,{className:"h-5 w-5"}),"Panier en cours"]})}),(0,s.jsx)(m.F,{className:"flex-1 p-4",children:0===r.length?(0,s.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-muted-foreground space-y-4 opacity-50",children:[(0,s.jsx)(l,{className:"h-16 w-16"}),(0,s.jsx)("p",{children:"En attente de produits..."})]}):(0,s.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg shadow-sm border",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.price," x ",e.quantity]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.$,{size:"icon",variant:"outline",className:"h-8 w-8",onClick:()=>S(e.id,-1),children:(0,s.jsx)(d,{className:"h-3 w-3"})}),(0,s.jsx)("span",{className:"w-8 text-center font-bold",children:e.quantity}),(0,s.jsx)(x.$,{size:"icon",variant:"outline",className:"h-8 w-8",onClick:()=>S(e.id,1),children:(0,s.jsx)(c.A,{className:"h-3 w-3"})})]}),(0,s.jsx)("div",{className:"ml-4 font-bold min-w-[60px] text-right",children:(e.price*e.quantity).toLocaleString()})]},e.id))})}),(0,s.jsxs)("div",{className:"p-6 bg-muted/10 border-t space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total HT"}),(0,s.jsxs)("span",{children:[q.toLocaleString()," F"]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"TVA (0%)"}),(0,s.jsx)("span",{children:"0 F"})]}),(0,s.jsx)(v.w,{className:"my-2"}),(0,s.jsxs)("div",{className:"flex justify-between text-2xl font-bold text-primary",children:[(0,s.jsx)("span",{children:"Net \xe0 Payer"}),(0,s.jsxs)("span",{children:[q.toLocaleString()," FCFA"]})]})]}),(0,s.jsxs)(x.$,{size:"lg",className:"w-full h-14 text-xl font-bold shadow-lg hover:scale-105 transition-transform",disabled:0===r.length,onClick:C,children:[(0,s.jsx)(p.A,{className:"mr-2 h-6 w-6"}),"ENCAISSER"]})]})]})]})}function g(){return(0,s.jsx)("div",{className:"flex-1 p-6 h-[calc(100vh-64px)] overflow-hidden",children:(0,s.jsx)(y,{})})}},5102:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var s=r(2725);r(1616);var a=r(7918),i=r(240);let n=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...r}){return(0,s.jsx)("div",{className:(0,i.cn)(n({variant:t}),e),...r})}},9007:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var s=r(2725),a=r(1616),i=r(240);let n=a.forwardRef(({className:e,type:t,...r},a)=>(0,s.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));n.displayName="Input"},5827:(e,t,r)=>{"use strict";r.d(t,{w:()=>c});var s=r(2725),a=r(1616),i=r(2713),n="horizontal",o=["horizontal","vertical"],l=a.forwardRef((e,t)=>{let{decorative:r,orientation:a=n,...l}=e,d=o.includes(a)?a:n;return(0,s.jsx)(i.sG.div,{"data-orientation":d,...r?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...l,ref:t})});l.displayName="Separator";var d=r(240);let c=a.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...a},i)=>(0,s.jsx)(l,{ref:i,decorative:r,orientation:t,className:(0,d.cn)("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...a}));c.displayName=l.displayName},2211:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2771).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\tinkpad\\\\Desktop\\\\Mes Nouveaux Projets\\\\Sahel Ubuntu Pharm\\\\apps\\\\web\\\\app\\\\pos\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\tinkpad\\Desktop\\Mes Nouveaux Projets\\Sahel Ubuntu Pharm\\apps\\web\\app\\pos\\page.tsx","default")},2713:(e,t,r)=>{"use strict";r.d(t,{sG:()=>n});var s=r(1616);r(7377);var a=r(9300),i=r(2725),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,a.TL)(`Primitive.${t}`),n=s.forwardRef((e,s)=>{let{asChild:a,...n}=e,o=a?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(o,{...n,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{})},2798:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8630).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1170:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8630).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[207,732,77],()=>r(4376));module.exports=s})();